{% extends '/include/layout.html' %}
{% block title %}Manage Prerequisites{% endblock %}
{% block header %}<h2>Manage Prerequisites</h2>{% endblock %}
{% block content %}
    {% for course in courses %}
    <h3>{{ course[1] }} ({{ course[0] }})</h3>

    <!-- Add Prereq Form -->
    <form class="clean-form" method="POST" action="{{ url_for('prereqs') }}">
        <input type="hidden" name="action" value="add">
        <input type="hidden" name="course_id" value="{{ course[0] }}">
        <label>Select Prerequisite Course:</label>
        <select name="prereq_id" required>
            <option value="">-- Select Course --</option>
            {% for c in all_courses %}
                {% if c[0] != course[0] %} {# prevent self-reference #}
                    <option value="{{ c[0] }}">{{ c[1] }} ({{ c[0] }})</option>
                {% endif %}
            {% endfor %}
        </select>
        <button onclick="return confirm('Add this prerequisite?');">Add Prerequisite</button>
    </form>

    <!-- Current Prereqs Table -->
    <h4>Current Prerequisites:</h4>
    <table class="clean-table">
        <thead>
            <tr>
                <th>Course ID</th>
                <th>Title</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for p in course_prereqs[course[0]] %}
            <tr>
                <td>{{ p[0] }}</td>
                <td>{{ p[1] }}</td>
                <td>
                    <form style="display:inline;" method="POST" action="{{ url_for('prereqs') }}">
                        <input type="hidden" name="action" value="remove">
                        <input type="hidden" name="course_id" value="{{ course[0] }}">
                        <input type="hidden" name="prereq_id" value="{{ p[0] }}">
                        <button onclick="return confirm('Remove this prerequisite?');">Remove</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endfor %}
{% endblock %}
